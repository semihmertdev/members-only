<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mesajlar</title>
  <link rel="stylesheet" href="/styles/styles.css">

</head>
<body>
  <% if (user) { %>
    <p>Hoş geldiniz, <%= user.full_name %>!</p>
    <a href="/new-message">Yeni Mesaj</a>
    <a href="/logout">Çıkış Yap</a>
    <% if (user.membership_status) { %>
      <p>Üyelik Durumu: Aktif</p>
    <% } else { %>
      <a href="/join">Kulübe Katıl</a>
    <% } %>
  <% } else { %>
    <a href="/signup">Kayıt Ol</a>
    <a href="/login">Giriş Yap</a>
  <% } %>

  <% if (user) { %>
    <h1>Mesajlar</h1>
    <% messages.forEach(message => { %>
      <div>
        <h2><%= message.title %></h2>
        <p><%= message.text %></p>
        <% if (user.membership_status) { %>
          <% if (message.User) { %> 
            <p>Yazar: <%= message.User.full_name %></p>
          <% } else { %>
            <p>Yazar bilgisi mevcut değil.</p>
          <% } %>
          <p>Tarih: <%= message.timestamp %></p>
          <% if (user.is_admin) { %>
            <form action="/delete-message/<%= message.id %>" method="POST">
              <button type="submit">Sil</button>
            </form>
          <% } %>
        <% } %>
      </div>
    <% }) %>
  <% } %>
  
</body>
</html>
